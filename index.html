<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Casino</title>
    <style>
        body {
            background: #0f0f0f;
            color: white;
            font-family: Arial, sans-serif;
        }
        input, button {
            padding: 6px;
            margin: 4px;
        }
        .hidden { display: none; }
        .box {
            border: 1px solid #333;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>

<h1>Casino</h1>

<!-- LOGIN -->
<div id="loginBox" class="box">
    <h2>Login / Register</h2>
    <input id="username" placeholder="Username"><br>
    <input id="password" type="password" placeholder="Password"><br>
    <button onclick="login()">Login</button>
    <button onclick="register()">Register</button>
    <p id="loginMsg"></p>
</div>

<!-- MAIN -->
<div id="mainBox" class="hidden box">
    <h2>Welcome, <span id="userDisplay"></span></h2>
    <p>Coins: <span id="coinDisplay">0</span></p>

    <button onclick="logout()">Logout</button>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="hidden box">
        <h3>Admin Panel</h3>
        <input id="adminTarget" placeholder="Target username"><br>
        <input id="adminAmount" type="number" placeholder="Coins (+ or -)"><br>
        <button onclick="adminUpdateCoins()">Apply</button>
        <p id="adminMsg"></p>
    </div>
</div>

<script>
/* ---------- STORAGE HELPERS ---------- */
function getUsers() {
    return JSON.parse(localStorage.getItem("users") || "{}");
}
function saveUsers(users) {
    localStorage.setItem("users", JSON.stringify(users));
}

/* ---------- AUTH ---------- */
let currentUser = null;

function register() {
    const u = username.value.trim();
    const p = password.value;

    if (!u || !p) {
        loginMsg.textContent = "Missing fields";
        return;
    }

    const users = getUsers();
    if (users[u]) {
        loginMsg.textContent = "User already exists";
        return;
    }

    users[u] = {
        password: p,
        coins: 0
    };
    saveUsers(users);

    loginMsg.textContent = "Registered. You can login.";
}

function login() {
    const u = username.value.trim();
    const p = password.value;

    const users = getUsers();
    if (!users[u] || users[u].password !== p) {
        loginMsg.textContent = "Invalid login";
        return;
    }

    currentUser = u;
    localStorage.setItem("currentUser", u);
    showMain();
}

function logout() {
    localStorage.removeItem("currentUser");
    location.reload();
}

/* ---------- MAIN UI ---------- */
function showMain() {
    const users = getUsers();
    if (!users[currentUser]) return;

    loginBox.classList.add("hidden");
    mainBox.classList.remove("hidden");

    userDisplay.textContent = currentUser;
    coinDisplay.textContent = users[currentUser].coins;

    // ADMIN CHECK
    if (currentUser === "FF2DMD") {
        adminPanel.classList.remove("hidden");
    } else {
        adminPanel.classList.add("hidden");
    }
}

/* ---------- ADMIN ---------- */
function adminUpdateCoins() {
    if (currentUser !== "FF2DMD") return;

    const target = adminTarget.value.trim();
    const amount = Number(adminAmount.value);

    const users = getUsers();
    if (!users[target] || isNaN(amount)) {
        adminMsg.textContent = "Invalid input";
        return;
    }

    users[target].coins += amount;
    if (users[target].coins < 0) users[target].coins = 0;

    saveUsers(users);

    if (target === currentUser) {
        coinDisplay.textContent = users[target].coins;
    }

    adminMsg.textContent = "Coins updated";
}

/* ---------- AUTO LOGIN ---------- */
window.onload = () => {
    const saved = localStorage.getItem("currentUser");
    if (saved) {
        currentUser = saved;
        showMain();
    }
};
</script>

</body>
</html>
